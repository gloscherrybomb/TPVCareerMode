<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prediction Accuracy Analysis | TPV Career Mode</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg-primary: #0a0e17;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --bg-elevated: #232d42;
            --border-color: #2d3a52;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;

            /* ARR Band Colors */
            --diamond: #22d3ee;
            --diamond-glow: rgba(34, 211, 238, 0.3);
            --platinum: #a1a1aa;
            --platinum-glow: rgba(161, 161, 170, 0.3);
            --gold: #fbbf24;
            --gold-glow: rgba(251, 191, 36, 0.3);
            --silver: #9ca3af;
            --silver-glow: rgba(156, 163, 175, 0.3);
            --bronze: #d97706;
            --bronze-glow: rgba(217, 119, 6, 0.3);

            /* Accent colors */
            --accent-positive: #10b981;
            --accent-negative: #ef4444;
            --accent-neutral: #6366f1;
            --accent-highlight: #f472b6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Grid background pattern */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image:
                linear-gradient(rgba(45, 58, 82, 0.15) 1px, transparent 1px),
                linear-gradient(90deg, rgba(45, 58, 82, 0.15) 1px, transparent 1px);
            background-size: 40px 40px;
            pointer-events: none;
            z-index: 0;
        }

        .dashboard {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Header */
        .header {
            margin-bottom: 2.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .header h1 {
            font-size: 1.75rem;
            font-weight: 600;
            letter-spacing: -0.02em;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .header h1::before {
            content: '';
            display: block;
            width: 4px;
            height: 28px;
            background: linear-gradient(180deg, var(--accent-highlight), var(--accent-neutral));
            border-radius: 2px;
        }

        .header-meta {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-muted);
            display: flex;
            gap: 1.5rem;
        }

        .header-meta span {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: var(--accent-positive);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Key Metrics Grid */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .metric-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.25rem;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            border-color: var(--accent-neutral);
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(99, 102, 241, 0.15);
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-neutral), var(--accent-highlight));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .metric-card:hover::before {
            opacity: 1;
        }

        .metric-label {
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }

        .metric-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
            line-height: 1.1;
        }

        .metric-value.highlight {
            color: var(--accent-highlight);
        }

        .metric-value.positive {
            color: var(--accent-positive);
        }

        .metric-value.negative {
            color: var(--accent-negative);
        }

        .metric-subtext {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        /* Section Headers */
        .section-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            margin-top: 2rem;
        }

        .section-header h2 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .section-header::after {
            content: '';
            flex: 1;
            height: 1px;
            background: linear-gradient(90deg, var(--border-color), transparent);
        }

        /* Charts Container */
        .charts-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        @media (max-width: 1024px) {
            .charts-row {
                grid-template-columns: 1fr;
            }
        }

        .chart-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
        }

        .chart-card.full-width {
            grid-column: 1 / -1;
        }

        .chart-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .chart-subtitle {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-bottom: 1rem;
        }

        .chart-container {
            position: relative;
            height: 280px;
        }

        .chart-container.tall {
            height: 350px;
        }

        /* ARR Band Table */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }

        .data-table th {
            text-align: left;
            padding: 0.75rem 1rem;
            background: var(--bg-elevated);
            color: var(--text-muted);
            font-weight: 500;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-color);
        }

        .data-table th:first-child {
            border-radius: 8px 0 0 0;
        }

        .data-table th:last-child {
            border-radius: 0 8px 0 0;
        }

        .data-table td {
            padding: 0.875rem 1rem;
            border-bottom: 1px solid var(--border-color);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        .data-table tr:hover td {
            background: var(--bg-elevated);
        }

        .band-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-family: 'Outfit', sans-serif;
            font-weight: 500;
        }

        .band-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .band-dot.diamond { background: var(--diamond); box-shadow: 0 0 8px var(--diamond-glow); }
        .band-dot.platinum { background: var(--platinum); box-shadow: 0 0 8px var(--platinum-glow); }
        .band-dot.gold { background: var(--gold); box-shadow: 0 0 8px var(--gold-glow); }
        .band-dot.silver { background: var(--silver); box-shadow: 0 0 8px var(--silver-glow); }
        .band-dot.bronze { background: var(--bronze); box-shadow: 0 0 8px var(--bronze-glow); }

        .trend-positive {
            color: var(--accent-positive);
        }

        .trend-negative {
            color: var(--accent-negative);
        }

        .trend-neutral {
            color: var(--text-muted);
        }

        /* Comparison Cards */
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }

        @media (max-width: 768px) {
            .comparison-grid {
                grid-template-columns: 1fr;
            }
        }

        .comparison-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
        }

        .comparison-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .comparison-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .comparison-icon.human {
            background: linear-gradient(135deg, var(--accent-highlight), #ec4899);
        }

        .comparison-icon.bot {
            background: linear-gradient(135deg, var(--accent-neutral), #8b5cf6);
        }

        .comparison-title {
            font-weight: 600;
            font-size: 1rem;
        }

        .comparison-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
        }

        .comparison-stat {
            text-align: center;
        }

        .comparison-stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .comparison-stat-label {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Insights Panel */
        .insights-panel {
            background: linear-gradient(135deg, var(--bg-card), var(--bg-elevated));
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 2rem;
        }

        .insights-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .insights-title::before {
            content: '!';
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: var(--accent-highlight);
            color: var(--bg-primary);
            font-weight: 700;
            font-size: 0.875rem;
            border-radius: 6px;
        }

        .insights-list {
            display: grid;
            gap: 0.75rem;
        }

        .insight-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.75rem;
            background: var(--bg-secondary);
            border-radius: 8px;
            font-size: 0.875rem;
            line-height: 1.5;
        }

        .insight-badge {
            flex-shrink: 0;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .insight-badge.critical {
            background: rgba(239, 68, 68, 0.2);
            color: var(--accent-negative);
        }

        .insight-badge.warning {
            background: rgba(251, 191, 36, 0.2);
            color: var(--gold);
        }

        .insight-badge.info {
            background: rgba(99, 102, 241, 0.2);
            color: var(--accent-neutral);
        }

        /* Footer */
        .footer {
            margin-top: 3rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .footer a {
            color: var(--accent-neutral);
            text-decoration: none;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .metric-card, .chart-card, .comparison-card, .insights-panel {
            animation: fadeInUp 0.6s ease-out backwards;
        }

        .metric-card:nth-child(1) { animation-delay: 0.1s; }
        .metric-card:nth-child(2) { animation-delay: 0.15s; }
        .metric-card:nth-child(3) { animation-delay: 0.2s; }
        .metric-card:nth-child(4) { animation-delay: 0.25s; }
        .metric-card:nth-child(5) { animation-delay: 0.3s; }

        .chart-card:nth-child(1) { animation-delay: 0.35s; }
        .chart-card:nth-child(2) { animation-delay: 0.4s; }

        .comparison-card:nth-child(1) { animation-delay: 0.45s; }
        .comparison-card:nth-child(2) { animation-delay: 0.5s; }

        .insights-panel { animation-delay: 0.55s; }
    </style>
</head>
<body>
    <div class="dashboard">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div>
                    <h1>Prediction Accuracy Analysis</h1>
                    <p style="color: var(--text-secondary); margin-top: 0.25rem;">TPV Career Mode - Season 1</p>
                </div>
                <div class="header-meta">
                    <span><span class="status-dot"></span> Live Data</span>
                    <span>4,710 Results</span>
                    <span>128 Races</span>
                </div>
            </div>
        </header>

        <!-- Key Metrics -->
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-label">Mean Absolute Error</div>
                <div class="metric-value highlight">8.41</div>
                <div class="metric-subtext">positions off on average</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Exact Predictions</div>
                <div class="metric-value">5.7%</div>
                <div class="metric-subtext">269 of 4,710 results</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Within 3 Positions</div>
                <div class="metric-value positive">31.0%</div>
                <div class="metric-subtext">1,460 results</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Within 5 Positions</div>
                <div class="metric-value positive">44.5%</div>
                <div class="metric-subtext">2,096 results</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Prediction Bias</div>
                <div class="metric-value" style="color: var(--text-secondary);">0.00</div>
                <div class="metric-subtext">balanced (no systematic bias)</div>
            </div>
        </div>

        <!-- Distribution Chart -->
        <div class="section-header">
            <h2>Error Distribution</h2>
        </div>

        <div class="chart-card full-width">
            <div class="chart-title">Prediction Error Distribution</div>
            <div class="chart-subtitle">Negative = finished better than predicted | Positive = finished worse than predicted</div>
            <div class="chart-container tall">
                <canvas id="distributionChart"></canvas>
            </div>
        </div>

        <!-- ARR Band Analysis -->
        <div class="section-header">
            <h2>Accuracy by ARR Band</h2>
        </div>

        <div class="charts-row">
            <div class="chart-card">
                <div class="chart-title">Mean Absolute Error by Band</div>
                <div class="chart-subtitle">Lower is better - shows prediction accuracy per skill tier</div>
                <div class="chart-container">
                    <canvas id="maeChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <div class="chart-title">Within 3 Positions Rate</div>
                <div class="chart-subtitle">Percentage of predictions within 3 positions of actual</div>
                <div class="chart-container">
                    <canvas id="within3Chart"></canvas>
                </div>
            </div>
        </div>

        <!-- ARR Band Table -->
        <div class="chart-card full-width">
            <div class="chart-title">Detailed ARR Band Breakdown</div>
            <div class="chart-subtitle">Complete statistics for each skill tier</div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>ARR Band</th>
                        <th>Results</th>
                        <th>MAE</th>
                        <th>Within 3</th>
                        <th>Avg Diff</th>
                        <th>Trend</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="band-indicator"><span class="band-dot diamond"></span>Diamond</span></td>
                        <td>7</td>
                        <td>0.00</td>
                        <td>100.0%</td>
                        <td class="trend-neutral">0.00</td>
                        <td class="trend-neutral">Perfect (limited data)</td>
                    </tr>
                    <tr>
                        <td><span class="band-indicator"><span class="band-dot platinum"></span>Platinum</span></td>
                        <td>1,232</td>
                        <td style="color: var(--accent-negative);">10.43</td>
                        <td>25.2%</td>
                        <td class="trend-negative">+1.10</td>
                        <td class="trend-negative">Finish worse than predicted</td>
                    </tr>
                    <tr>
                        <td><span class="band-indicator"><span class="band-dot gold"></span>Gold</span></td>
                        <td>1,659</td>
                        <td>8.53</td>
                        <td>29.1%</td>
                        <td class="trend-negative">+0.21</td>
                        <td class="trend-neutral">Slightly optimistic</td>
                    </tr>
                    <tr>
                        <td><span class="band-indicator"><span class="band-dot silver"></span>Silver</span></td>
                        <td>908</td>
                        <td>7.52</td>
                        <td>32.3%</td>
                        <td class="trend-positive">-0.22</td>
                        <td class="trend-neutral">Well balanced</td>
                    </tr>
                    <tr>
                        <td><span class="band-indicator"><span class="band-dot bronze"></span>Bronze</span></td>
                        <td>821</td>
                        <td style="color: var(--accent-positive);">6.19</td>
                        <td style="color: var(--accent-positive);">40.3%</td>
                        <td class="trend-positive">-1.56</td>
                        <td class="trend-positive">Finish better than predicted</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Human vs Bot Comparison -->
        <div class="section-header">
            <h2>Human vs Bot Comparison</h2>
        </div>

        <div class="comparison-grid">
            <div class="comparison-card">
                <div class="comparison-header">
                    <div class="comparison-icon human">&#x1F464;</div>
                    <div>
                        <div class="comparison-title">Human Riders</div>
                        <div style="font-size: 0.75rem; color: var(--text-muted);">120 results</div>
                    </div>
                </div>
                <div class="comparison-stats">
                    <div class="comparison-stat">
                        <div class="comparison-stat-value" style="color: var(--accent-negative);">9.70</div>
                        <div class="comparison-stat-label">MAE</div>
                    </div>
                    <div class="comparison-stat">
                        <div class="comparison-stat-value" style="color: var(--accent-positive);">12.5%</div>
                        <div class="comparison-stat-label">Exact</div>
                    </div>
                    <div class="comparison-stat">
                        <div class="comparison-stat-value" style="color: var(--accent-positive);">-1.67</div>
                        <div class="comparison-stat-label">Avg Diff</div>
                    </div>
                </div>
                <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-color); font-size: 0.8rem; color: var(--text-secondary);">
                    Humans beat predictions more often but are less predictable overall
                </div>
            </div>

            <div class="comparison-card">
                <div class="comparison-header">
                    <div class="comparison-icon bot">&#x1F916;</div>
                    <div>
                        <div class="comparison-title">Bot Riders</div>
                        <div style="font-size: 0.75rem; color: var(--text-muted);">4,590 results</div>
                    </div>
                </div>
                <div class="comparison-stats">
                    <div class="comparison-stat">
                        <div class="comparison-stat-value" style="color: var(--accent-positive);">8.38</div>
                        <div class="comparison-stat-label">MAE</div>
                    </div>
                    <div class="comparison-stat">
                        <div class="comparison-stat-value">5.5%</div>
                        <div class="comparison-stat-label">Exact</div>
                    </div>
                    <div class="comparison-stat">
                        <div class="comparison-stat-value" style="color: var(--text-secondary);">+0.04</div>
                        <div class="comparison-stat-label">Avg Diff</div>
                    </div>
                </div>
                <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-color); font-size: 0.8rem; color: var(--text-secondary);">
                    Bots are more predictable with nearly balanced performance
                </div>
            </div>
        </div>

        <!-- Field Size Impact -->
        <div class="section-header">
            <h2>Field Size Impact</h2>
        </div>

        <div class="chart-card full-width">
            <div class="chart-title">Prediction Accuracy by Field Size</div>
            <div class="chart-subtitle">How race size affects prediction accuracy</div>
            <div class="chart-container">
                <canvas id="fieldSizeChart"></canvas>
            </div>
        </div>

        <!-- Key Insights -->
        <div class="insights-panel">
            <div class="insights-title">Key Findings for Developers</div>
            <div class="insights-list">
                <div class="insight-item">
                    <span class="insight-badge critical">Critical</span>
                    <span><strong>Platinum tier has worst accuracy</strong> (MAE 10.43) - predictions are too optimistic for high-skill riders. Consider adjusting rating weights for ARR 1300-1599.</span>
                </div>
                <div class="insight-item">
                    <span class="insight-badge warning">Warning</span>
                    <span><strong>Platinum 1 sub-band bias:</strong> Riders finish +8.99 positions worse than predicted on average. Only 22.9% beat their prediction in this tier.</span>
                </div>
                <div class="insight-item">
                    <span class="insight-badge info">Pattern</span>
                    <span><strong>Bronze riders consistently outperform</strong> predictions (-1.56 avg diff). The model may be underestimating lower-rated riders.</span>
                </div>
                <div class="insight-item">
                    <span class="insight-badge info">Pattern</span>
                    <span><strong>Field size matters:</strong> Smaller fields (11-30 riders) have much better accuracy (MAE ~4.8) vs larger fields (MAE ~8.5). Consider field-size calibration.</span>
                </div>
                <div class="insight-item">
                    <span class="insight-badge warning">Warning</span>
                    <span><strong>Human unpredictability:</strong> Humans are less predictable (MAE 9.70 vs 8.38) but beat predictions more often. May need separate modeling.</span>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div>Generated from 128 race files | <a href="prediction_accuracy_data.csv">Download CSV Data</a> | <a href="PREDICTION_ACCURACY_REPORT.txt">Full Report</a></div>
            <div>TPV Career Mode Prediction Analysis</div>
        </footer>
    </div>

    <script>
        // Chart.js global defaults
        Chart.defaults.color = '#94a3b8';
        Chart.defaults.borderColor = '#2d3a52';
        Chart.defaults.font.family = "'Outfit', sans-serif";

        // Distribution Chart
        const distributionCtx = document.getElementById('distributionChart').getContext('2d');
        const distributionData = {
            labels: ['-10 or less', '-9', '-8', '-7', '-6', '-5', '-4', '-3', '-2', '-1', '0 (exact)', '+1', '+2', '+3', '+4', '+5', '+6', '+7', '+8', '+9', '+10 or more'],
            datasets: [{
                label: 'Count',
                data: [790, 101, 125, 154, 122, 176, 174, 189, 199, 221, 269, 224, 204, 156, 151, 131, 150, 110, 96, 98, 870],
                backgroundColor: function(context) {
                    const index = context.dataIndex;
                    if (index < 10) return 'rgba(16, 185, 129, 0.7)'; // Better than predicted - green
                    if (index === 10) return 'rgba(99, 102, 241, 0.9)'; // Exact - purple
                    return 'rgba(239, 68, 68, 0.7)'; // Worse than predicted - red
                },
                borderColor: function(context) {
                    const index = context.dataIndex;
                    if (index < 10) return '#10b981';
                    if (index === 10) return '#6366f1';
                    return '#ef4444';
                },
                borderWidth: 1,
                borderRadius: 4,
            }]
        };

        new Chart(distributionCtx, {
            type: 'bar',
            data: distributionData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: '#1a2234',
                        borderColor: '#2d3a52',
                        borderWidth: 1,
                        titleFont: { family: "'JetBrains Mono', monospace" },
                        bodyFont: { family: "'JetBrains Mono', monospace" },
                        callbacks: {
                            title: function(items) {
                                const idx = items[0].dataIndex;
                                if (idx < 10) return `${items[0].label} positions (beat prediction)`;
                                if (idx === 10) return 'Exact prediction';
                                return `+${idx - 10} positions (missed prediction)`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: { color: '#2d3a52' },
                        ticks: { font: { family: "'JetBrains Mono', monospace", size: 10 } }
                    },
                    x: {
                        grid: { display: false },
                        ticks: {
                            font: { family: "'JetBrains Mono', monospace", size: 9 },
                            maxRotation: 45,
                            minRotation: 45
                        }
                    }
                }
            }
        });

        // MAE by Band Chart
        const maeCtx = document.getElementById('maeChart').getContext('2d');
        new Chart(maeCtx, {
            type: 'bar',
            data: {
                labels: ['Diamond', 'Platinum', 'Gold', 'Silver', 'Bronze'],
                datasets: [{
                    label: 'MAE',
                    data: [0.00, 10.43, 8.53, 7.52, 6.19],
                    backgroundColor: [
                        'rgba(34, 211, 238, 0.7)',
                        'rgba(161, 161, 170, 0.7)',
                        'rgba(251, 191, 36, 0.7)',
                        'rgba(156, 163, 175, 0.7)',
                        'rgba(217, 119, 6, 0.7)'
                    ],
                    borderColor: ['#22d3ee', '#a1a1aa', '#fbbf24', '#9ca3af', '#d97706'],
                    borderWidth: 2,
                    borderRadius: 6,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y',
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: '#1a2234',
                        borderColor: '#2d3a52',
                        borderWidth: 1,
                        callbacks: {
                            label: function(context) {
                                return `MAE: ${context.raw.toFixed(2)} positions`;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        beginAtZero: true,
                        max: 12,
                        grid: { color: '#2d3a52' },
                        ticks: { font: { family: "'JetBrains Mono', monospace" } }
                    },
                    y: {
                        grid: { display: false },
                        ticks: { font: { weight: 500 } }
                    }
                }
            }
        });

        // Within 3 Chart
        const within3Ctx = document.getElementById('within3Chart').getContext('2d');
        new Chart(within3Ctx, {
            type: 'bar',
            data: {
                labels: ['Diamond', 'Platinum', 'Gold', 'Silver', 'Bronze'],
                datasets: [{
                    label: 'Within 3',
                    data: [100, 25.2, 29.1, 32.3, 40.3],
                    backgroundColor: [
                        'rgba(34, 211, 238, 0.7)',
                        'rgba(161, 161, 170, 0.7)',
                        'rgba(251, 191, 36, 0.7)',
                        'rgba(156, 163, 175, 0.7)',
                        'rgba(217, 119, 6, 0.7)'
                    ],
                    borderColor: ['#22d3ee', '#a1a1aa', '#fbbf24', '#9ca3af', '#d97706'],
                    borderWidth: 2,
                    borderRadius: 6,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y',
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: '#1a2234',
                        borderColor: '#2d3a52',
                        borderWidth: 1,
                        callbacks: {
                            label: function(context) {
                                return `Within 3: ${context.raw.toFixed(1)}%`;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        beginAtZero: true,
                        max: 100,
                        grid: { color: '#2d3a52' },
                        ticks: {
                            font: { family: "'JetBrains Mono', monospace" },
                            callback: function(value) { return value + '%'; }
                        }
                    },
                    y: {
                        grid: { display: false },
                        ticks: { font: { weight: 500 } }
                    }
                }
            }
        });

        // Field Size Chart
        const fieldSizeCtx = document.getElementById('fieldSizeChart').getContext('2d');
        new Chart(fieldSizeCtx, {
            type: 'line',
            data: {
                labels: ['11-20', '21-30', '31-40', '51+'],
                datasets: [
                    {
                        label: 'MAE',
                        data: [4.63, 4.93, 8.51, 8.51],
                        borderColor: '#f472b6',
                        backgroundColor: 'rgba(244, 114, 182, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#f472b6',
                        pointBorderColor: '#0a0e17',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        yAxisID: 'y'
                    },
                    {
                        label: 'Within 3%',
                        data: [49.5, 53.6, 30.5, 30.9],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#10b981',
                        pointBorderColor: '#0a0e17',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        yAxisID: 'y1'
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: {
                    mode: 'index',
                    intersect: false,
                },
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            usePointStyle: true,
                            padding: 20
                        }
                    },
                    tooltip: {
                        backgroundColor: '#1a2234',
                        borderColor: '#2d3a52',
                        borderWidth: 1,
                    }
                },
                scales: {
                    x: {
                        grid: { color: '#2d3a52' },
                        title: {
                            display: true,
                            text: 'Field Size (riders)',
                            color: '#64748b'
                        }
                    },
                    y: {
                        type: 'linear',
                        display: true,
                        position: 'left',
                        beginAtZero: true,
                        max: 12,
                        grid: { color: '#2d3a52' },
                        title: {
                            display: true,
                            text: 'MAE (positions)',
                            color: '#f472b6'
                        },
                        ticks: {
                            font: { family: "'JetBrains Mono', monospace" },
                            color: '#f472b6'
                        }
                    },
                    y1: {
                        type: 'linear',
                        display: true,
                        position: 'right',
                        beginAtZero: true,
                        max: 60,
                        grid: { drawOnChartArea: false },
                        title: {
                            display: true,
                            text: 'Within 3 (%)',
                            color: '#10b981'
                        },
                        ticks: {
                            font: { family: "'JetBrains Mono', monospace" },
                            color: '#10b981',
                            callback: function(value) { return value + '%'; }
                        }
                    }
                }
            }
        });
    </script>
</body>
</html>
