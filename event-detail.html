<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Detail - TPV Career Mode</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="event-detail.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <span class="logo-text">TPV</span>
                <span class="logo-subtitle">Career Mode</span>
            </div>
            <div class="nav-links">
                <a href="index.html" class="nav-link">Home</a>
                <a href="events.html" class="nav-link">Events</a>
                <a href="peloton.html" class="nav-link">Peloton</a>
                <a href="standings.html" class="nav-link">Standings</a>
                <a href="#" class="nav-link nav-login" id="loginBtn">Login</a>
            </div>
            <button class="nav-toggle" id="navToggle">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <div class="event-hero">
        <div class="hero-background"></div>
        <div class="container">
            <div class="breadcrumb">
                <a href="index.html">Home</a> / <a href="events.html">Events</a> / Event 01
            </div>
            <div class="event-hero-content">
                <div class="event-badge">Event 01 ‚Ä¢ Local Amateur</div>
                <h1 class="event-hero-title">The First Pedal</h1>
                <p class="event-hero-subtitle">Your journey begins on familiar roads</p>
            </div>
        </div>
    </div>

    <section class="event-overview">
        <div class="container">
            <div class="overview-grid">
                <div class="overview-card">
                    <div class="overview-icon">üìè</div>
                    <div class="overview-label">Distance</div>
                    <div class="overview-value">45 km</div>
                </div>
                <div class="overview-card">
                    <div class="overview-icon">‚è±Ô∏è</div>
                    <div class="overview-label">Est. Time</div>
                    <div class="overview-value">~75 min</div>
                </div>
                <div class="overview-card">
                    <div class="overview-icon">‚õ∞Ô∏è</div>
                    <div class="overview-label">Elevation</div>
                    <div class="overview-value">420 m</div>
                </div>
                <div class="overview-card">
                    <div class="overview-icon">üéØ</div>
                    <div class="overview-label">Difficulty</div>
                    <div class="overview-value">Moderate</div>
                </div>
            </div>
        </div>
    </section>

    <section class="event-story">
        <div class="container">
            <div class="story-content">
                <h2 class="story-title">The Story</h2>
                <div class="story-text">
                    <p>Every champion started somewhere. For you, that somewhere is here‚Äîon the winding roads of your local circuit, where dreams are tested against reality, and potential meets pavement.</p>

                    <p>The morning air is crisp as you line up with dozens of other hopefuls. Some have been racing these roads for years. Others, like you, are just beginning to understand what it means to push beyond comfort, to find that extra gear when your body screams to stop.</p>

                    <p>This isn't just a race. It's a declaration. A statement that you're willing to chase something greater than easy victories and comfortable rides. The peloton ahead doesn't know your name yet, but they will.</p>

                    <p>Today, you take your first pedal stroke toward greatness. The road is long, and the journey has just begun. But in this moment, on this familiar circuit, you have everything you need: your bike, your determination, and the courage to start.</p>

                    <div class="story-callout">
                        <div class="callout-icon">üí°</div>
                        <div class="callout-text">
                            <strong>Race Strategy:</strong> Pace yourself carefully. The temptation to go out fast is strong, but conservation is key. Stay in the draft, watch for attacks in the final 10km, and save your sprint for when it counts.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="event-route">
        <div class="container">
            <h2 class="section-title-medium">Route Profile</h2>
            <div class="route-placeholder">
                <p>Route elevation profile will be displayed here</p>
                <div class="route-details-grid">
                    <div class="route-detail">
                        <strong>Start:</strong> Town Square
                    </div>
                    <div class="route-detail">
                        <strong>Key Climb:</strong> Oak Hill (km 25-28)
                    </div>
                    <div class="route-detail">
                        <strong>Sprint Point:</strong> Riverside (km 35)
                    </div>
                    <div class="route-detail">
                        <strong>Finish:</strong> Town Square
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="event-scoring">
        <div class="container">
            <h2 class="section-title-medium">Scoring System</h2>
            <div class="scoring-grid">
                <div class="scoring-card">
                    <div class="scoring-rank">1st</div>
                    <div class="scoring-points">100 pts</div>
                </div>
                <div class="scoring-card">
                    <div class="scoring-rank">2nd</div>
                    <div class="scoring-points">85 pts</div>
                </div>
                <div class="scoring-card">
                    <div class="scoring-rank">3rd</div>
                    <div class="scoring-points">75 pts</div>
                </div>
                <div class="scoring-card">
                    <div class="scoring-rank">4th</div>
                    <div class="scoring-points">70 pts</div>
                </div>
                <div class="scoring-card">
                    <div class="scoring-rank">5th</div>
                    <div class="scoring-points">65 pts</div>
                </div>
                <div class="scoring-card">
                    <div class="scoring-rank">6th-10th</div>
                    <div class="scoring-points">60-50 pts</div>
                </div>
                <div class="scoring-card">
                    <div class="scoring-rank">11th-20th</div>
                    <div class="scoring-points">45-30 pts</div>
                </div>
                <div class="scoring-card">
                    <div class="scoring-rank">Completion</div>
                    <div class="scoring-points">25 pts</div>
                </div>
            </div>
            <p class="scoring-note">Points are awarded based on your finishing position. Complete the event to unlock the next challenge.</p>
        </div>
    </section>

    <section class="event-cta">
        <div class="container">
            <div class="cta-box">
                <h2>Ready to Race?</h2>
                <p>Schedule this event on TrainingPeaks Virtual and complete it to progress in your career.</p>
                <div class="cta-buttons">
                    <button class="btn btn-primary btn-large">Schedule Event</button>
                    <button class="btn btn-secondary btn-large" onclick="location.href='events.html'">Back to Events</button>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <div class="footer-logo">TPV Career Mode</div>
                    <p>Virtual cycling career progression</p>
                </div>
                <div class="footer-links">
                    <a href="index.html">Home</a>
                    <a href="events.html">Events</a>
                    <a href="peloton.html">Meet the Peloton</a>
                    <a href="standings.html">Standings</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 TrainingPeaks Virtual Career Mode. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-overlay" id="modalOverlay"></div>
        <div class="modal-content">
            <button class="modal-close" id="modalClose">&times;</button>
            <h2 class="modal-title">Welcome Back</h2>
            <div class="modal-tabs">
                <button class="modal-tab active" data-tab="login">Login</button>
                <button class="modal-tab" data-tab="signup">Sign Up</button>
            </div>
            
            <div class="tab-content active" id="loginTab">
                <form class="auth-form" id="loginForm">
                    <div class="form-group">
                        <label for="loginEmail">Email</label>
                        <input type="email" id="loginEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Login</button>
                </form>
            </div>

            <div class="tab-content" id="signupTab">
                <form class="auth-form" id="signupForm">
                    <div class="form-group">
                        <label for="signupName">Rider Name</label>
                        <input type="text" id="signupName" required>
                    </div>
                    <div class="form-group">
                        <label for="signupEmail">Email</label>
                        <input type="email" id="signupEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="signupPassword">Password</label>
                        <input type="password" id="signupPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Create Account</button>
                </form>
            </div>
        </div>
    </div>

    <script src="event-data.js"></script>
    <script type="module" src="app.js"></script>
    <script>
        // Get event ID from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const eventId = urlParams.get('id') || '1';
        const event = getEvent(parseInt(eventId));

        if (!event) {
            window.location.href = 'events.html';
        }

        // Update page content
        document.addEventListener('DOMContentLoaded', () => {
            // Update title
            document.title = `${event.name} - TPV Career Mode`;

            // Update breadcrumb
            document.querySelector('.breadcrumb').innerHTML = `
                <a href="index.html">Home</a> / <a href="events.html">Events</a> / Event ${event.number}
            `;

            // Update hero section
            document.querySelector('.event-badge').textContent = `Event ${event.number} ‚Ä¢ ${event.level}`;
            document.querySelector('.event-hero-title').textContent = event.name;
            document.querySelector('.event-hero-subtitle').textContent = event.subtitle;

            // Update overview cards
            const overviewGrid = document.querySelector('.overview-grid');
            overviewGrid.innerHTML = `
                <div class="overview-card">
                    <div class="overview-icon">üìè</div>
                    <div class="overview-label">Distance</div>
                    <div class="overview-value">${event.distance}</div>
                </div>
                <div class="overview-card">
                    <div class="overview-icon">‚õ∞Ô∏è</div>
                    <div class="overview-label">Climbing</div>
                    <div class="overview-value">${event.climbing}</div>
                </div>
                <div class="overview-card">
                    <div class="overview-icon">üè∑Ô∏è</div>
                    <div class="overview-label">Type</div>
                    <div class="overview-value">${event.type}</div>
                </div>
                <div class="overview-card">
                    <div class="overview-icon">‚≠ê</div>
                    <div class="overview-label">Max Points</div>
                    <div class="overview-value">${event.maxPoints}</div>
                </div>
                <div class="overview-card">
                    <div class="overview-icon">${event.mandatory ? 'üî¥' : 'üü¢'}</div>
                    <div class="overview-label">Status</div>
                    <div class="overview-value">${event.mandatory ? 'Mandatory' : 'Optional'}</div>
                </div>
                <div class="overview-card">
                    <div class="overview-icon">üîÑ</div>
                    <div class="overview-label">Format</div>
                    <div class="overview-value">${event.format}</div>
                </div>
            `;

            // Update story section
            const storyText = document.querySelector('.story-text');
            const descriptionParagraphs = event.description.split('\n\n').map(p => `<p>${p.trim()}</p>`).join('');
            
            let storyHTML = descriptionParagraphs;
            
            if (event.strategy) {
                storyHTML += `
                    <div class="story-callout">
                        <div class="callout-icon">üí°</div>
                        <div class="callout-text">
                            <strong>Race Strategy:</strong> ${event.strategy}
                        </div>
                    </div>
                `;
            }

            // Add stage breakdown for stage races
            if (event.isStageRace && event.stages) {
                storyHTML += `
                    <div class="stage-race-breakdown">
                        <h3>Stage Breakdown</h3>
                        ${event.stages.map((stage, i) => `
                            <div class="stage-detail-card">
                                <div class="stage-detail-header">
                                    <span class="stage-detail-number">Stage ${i + 1}</span>
                                    <span class="stage-detail-points">${stage.points} pts</span>
                                </div>
                                <h4>${stage.name}</h4>
                                <div class="stage-detail-stats">
                                    <span>üìè ${stage.distance}</span>
                                    <span>‚õ∞Ô∏è ${stage.climbing}</span>
                                </div>
                                <p>${stage.description}</p>
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            storyText.innerHTML = storyHTML;

            // Update route details
            const routeDetailsGrid = document.querySelector('.route-details-grid');
            if (event.isStageRace) {
                routeDetailsGrid.innerHTML = `
                    <div class="route-detail">
                        <strong>Stage 1:</strong> ${event.routeDetails.stage1}
                    </div>
                    <div class="route-detail">
                        <strong>Stage 2:</strong> ${event.routeDetails.stage2}
                    </div>
                    <div class="route-detail">
                        <strong>Stage 3:</strong> ${event.routeDetails.stage3}
                    </div>
                    <div class="route-detail">
                        <strong>Difficulty:</strong> ${event.routeDetails.difficulty}
                    </div>
                `;
            } else {
                const routeKeys = Object.keys(event.routeDetails);
                routeDetailsGrid.innerHTML = routeKeys.map(key => `
                    <div class="route-detail">
                        <strong>${key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())}:</strong>
                        ${event.routeDetails[key]}
                    </div>
                `).join('');
            }

            // Update scoring section
            const scoringGrid = document.querySelector('.scoring-grid');
            const points = calculatePoints(event.maxPoints);
            scoringGrid.innerHTML = points.map(p => `
                <div class="scoring-card">
                    <div class="scoring-rank">${p.rank}</div>
                    <div class="scoring-points">${p.points} pts</div>
                </div>
            `).join('');

            // Update course name in breadcrumb callout
            document.querySelector('.scoring-note').textContent = 
                `Points are awarded based on your finishing position. Course: ${event.course}`;
        });
    </script>
</body>
</html>
