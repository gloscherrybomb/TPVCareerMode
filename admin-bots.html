<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bot Profile Admin - TPV Career Mode</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="tpv-team-car.png">
    <link rel="apple-touch-icon" href="tpv-team-car.png">
    
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="admin-bots.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <span class="logo-text">TPV</span>
                <span class="logo-subtitle">Admin</span>
            </div>
            <div class="nav-links">
                <a href="index.html" class="nav-link">Home</a>
                <a href="events.html" class="nav-link">Events</a>
                <a href="peloton.html" class="nav-link">Peloton</a>
                <a href="admin-bots.html" class="nav-link active">Bot Admin</a>
                <a href="#" class="nav-link nav-logout" id="logoutBtn">Logout</a>
            </div>
        </div>
    </nav>

    <!-- Auth Check Notice -->
    <div id="authCheck" class="auth-check">
        <div class="spinner"></div>
        <p>Checking authentication...</p>
    </div>

    <!-- Unauthorized Message -->
    <div id="unauthorized" class="unauthorized" style="display: none;">
        <div class="container">
            <div class="unauthorized-content">
                <div class="unauthorized-icon">ðŸ”’</div>
                <h2>Access Denied</h2>
                <p>You must be logged in as an administrator to access this page.</p>
                <button class="btn btn-primary" onclick="window.location.href='index.html'">Go Home</button>
            </div>
        </div>
    </div>

    <!-- Admin Content -->
    <div id="adminContent" style="display: none;">
        <!-- Page Header -->
        <div class="page-header">
            <div class="container">
                <div class="header-content">
                    <h1 class="page-title">Bot Profile Administration</h1>
                    <p class="page-subtitle">Create and manage bot rider profiles</p>
                </div>
            </div>
        </div>

        <!-- Admin Sections -->
        <section class="admin-section">
            <div class="container">
                <div class="admin-layout">
                    <!-- Left Side: Form -->
                    <div class="admin-form-container">
                        <div class="section-header">
                            <h2 id="formTitle">Add New Bot Profile</h2>
                            <button id="resetForm" class="btn btn-secondary btn-small" style="display: none;">Create New</button>
                        </div>

                        <form id="botProfileForm" class="bot-form">
                            <!-- UID -->
                            <div class="form-group">
                                <label for="botUid">Bot UID *</label>
                                <input 
                                    type="text" 
                                    id="botUid" 
                                    placeholder="e.g., Bot123ABC456DEF78"
                                    required
                                    maxlength="20">
                                <small class="field-help">Unique identifier (will be document ID in Firestore)</small>
                            </div>

                            <!-- Name -->
                            <div class="form-group">
                                <label for="botName">Name *</label>
                                <input 
                                    type="text" 
                                    id="botName" 
                                    placeholder="e.g., Marco DiCicco"
                                    required>
                            </div>

                            <!-- Team -->
                            <div class="form-group">
                                <label for="botTeam">Team *</label>
                                <input 
                                    type="text" 
                                    id="botTeam" 
                                    placeholder="e.g., Formix"
                                    required>
                            </div>

                            <!-- ARR -->
                            <div class="form-group">
                                <label for="botArr">ARR *</label>
                                <input 
                                    type="number" 
                                    id="botArr" 
                                    placeholder="e.g., 1250"
                                    min="800"
                                    max="2000"
                                    required>
                                <small class="field-help">Bronze: <1196 | Silver: 1196-1320 | Gold: 1321-1450 | Platinum: 1451+</small>
                            </div>

                            <!-- Gender -->
                            <div class="form-group">
                                <label for="botGender">Gender *</label>
                                <select id="botGender" required>
                                    <option value="">Select gender</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                    <option value="Non-binary">Non-binary</option>
                                </select>
                            </div>

                          <!-- Nationality -->
<div class="form-group">
    <label for="botNationality">Nationality *</label>
    <select id="botNationality" required>
        <option value="">Select nationality</option>

        <!-- A -->
        <option value="AFG">Afghanistan (AFG)</option>
        <option value="ALB">Albania (ALB)</option>
        <option value="ALG">Algeria (ALG)</option>
        <option value="AND">Andorra (AND)</option>
        <option value="ANG">Angola (ANG)</option>
        <option value="ANT">Antigua and Barbuda (ANT)</option>
        <option value="ARG">Argentina (ARG)</option>
        <option value="ARM">Armenia (ARM)</option>
        <option value="ARU">Aruba (ARU)</option>
        <option value="ASA">American Samoa (ASA)</option>
        <option value="AUS">Australia (AUS)</option>
        <option value="AUT">Austria (AUT)</option>
        <option value="AZE">Azerbaijan (AZE)</option>

        <!-- B -->
        <option value="BAH">Bahamas (BAH)</option>
        <option value="BAN">Bangladesh (BAN)</option>
        <option value="BAR">Barbados (BAR)</option>
        <option value="BDI">Burundi (BDI)</option>
        <option value="BEL">Belgium (BEL)</option>
        <option value="BEN">Benin (BEN)</option>
        <option value="BER">Bermuda (BER)</option>
        <option value="BHU">Bhutan (BHU)</option>
        <option value="BIH">Bosnia and Herzegovina (BIH)</option>
        <option value="BIZ">Belize (BIZ)</option>
        <option value="BLR">Belarus (BLR)</option>
        <option value="BOL">Bolivia (BOL)</option>
        <option value="BOT">Botswana (BOT)</option>
        <option value="BRA">Brazil (BRA)</option>
        <option value="BRN">Bahrain (BRN)</option>
        <option value="BRU">Brunei Darussalam (BRU)</option>
        <option value="BUL">Bulgaria (BUL)</option>
        <option value="BUR">Burkina Faso (BUR)</option>

        <!-- C -->
        <option value="CAF">Central African Republic (CAF)</option>
        <option value="CAM">Cambodia (CAM)</option>
        <option value="CAN">Canada (CAN)</option>
        <option value="CAY">Cayman Islands (CAY)</option>
        <option value="CGO">Congo (CGO)</option>
        <option value="CHA">Chad (CHA)</option>
        <option value="CHI">Chile (CHI)</option>
        <option value="CHN">China (CHN)</option>
        <option value="CIV">CÃ´te d'Ivoire (CIV)</option>
        <option value="CMR">Cameroon (CMR)</option>
        <option value="COD">Democratic Republic of the Congo (COD)</option>
        <option value="COK">Cook Islands (COK)</option>
        <option value="COL">Colombia (COL)</option>
        <option value="COM">Comoros (COM)</option>
        <option value="CPV">Cabo Verde (CPV)</option>
        <option value="CRC">Costa Rica (CRC)</option>
        <option value="CRO">Croatia (CRO)</option>
        <option value="CUB">Cuba (CUB)</option>
        <option value="CYP">Cyprus (CYP)</option>
        <option value="CZE">Czech Republic (CZE)</option>

        <!-- D -->
        <option value="DEN">Denmark (DEN)</option>
        <option value="DJI">Djibouti (DJI)</option>
        <option value="DMA">Dominica (DMA)</option>
        <option value="DOM">Dominican Republic (DOM)</option>

        <!-- E -->
        <option value="ECU">Ecuador (ECU)</option>
        <option value="EGY">Egypt (EGY)</option>
        <option value="ERI">Eritrea (ERI)</option>
        <option value="ESA">El Salvador (ESA)</option>
        <option value="ESP">Spain (ESP)</option>
        <option value="EST">Estonia (EST)</option>
        <option value="ETH">Ethiopia (ETH)</option>

        <!-- F -->
        <option value="FIJ">Fiji (FIJ)</option>
        <option value="FIN">Finland (FIN)</option>
        <option value="FRA">France (FRA)</option>

        <!-- G -->
        <option value="GAB">Gabon (GAB)</option>
        <option value="GAM">Gambia (GAM)</option>
        <option value="GBR">Great Britain (GBR)</option>
        <option value="GBS">Guinea-Bissau (GBS)</option>
        <option value="GEO">Georgia (GEO)</option>
        <option value="GEQ">Equatorial Guinea (GEQ)</option>
        <option value="GER">Germany (GER)</option>
        <option value="GHA">Ghana (GHA)</option>
        <option value="GRE">Greece (GRE)</option>
        <option value="GRN">Grenada (GRN)</option>
        <option value="GUA">Guatemala (GUA)</option>
        <option value="GUI">Guinea (GUI)</option>
        <option value="GUM">Guam (GUM)</option>
        <option value="GUY">Guyana (GUY)</option>

        <!-- H -->
        <option value="HAI">Haiti (HAI)</option>
        <option value="HKG">Hong Kong, China (HKG)</option>
        <option value="HON">Honduras (HON)</option>
        <option value="HUN">Hungary (HUN)</option>

        <!-- I -->
        <option value="INA">Indonesia (INA)</option>
        <option value="IND">India (IND)</option>
        <option value="IRI">Islamic Republic of Iran (IRI)</option>
        <option value="IRL">Ireland (IRL)</option>
        <option value="IRQ">Iraq (IRQ)</option>
        <option value="ISL">Iceland (ISL)</option>
        <option value="ISR">Israel (ISR)</option>
        <option value="ITA">Italy (ITA)</option>

        <!-- J -->
        <option value="JAM">Jamaica (JAM)</option>
        <option value="JOR">Jordan (JOR)</option>
        <option value="JPN">Japan (JPN)</option>

        <!-- K -->
        <option value="KAZ">Kazakhstan (KAZ)</option>
        <option value="KEN">Kenya (KEN)</option>
        <option value="KGZ">Kyrgyzstan (KGZ)</option>
        <option value="KIR">Kiribati (KIR)</option>
        <option value="KOR">Republic of Korea (KOR)</option>
        <option value="KOS">Kosovo (KOS)</option>
        <option value="KSA">Saudi Arabia (KSA)</option>
        <option value="KUW">Kuwait (KUW)</option>

        <!-- L -->
        <option value="LAO">Lao People's Democratic Republic (LAO)</option>
        <option value="LAT">Latvia (LAT)</option>
        <option value="LBA">Libya (LBA)</option>
        <option value="LBN">Lebanon (LBN)</option>
        <option value="LBR">Liberia (LBR)</option>
        <option value="LCA">Saint Lucia (LCA)</option>
        <option value="LES">Lesotho (LES)</option>
        <option value="LIE">Liechtenstein (LIE)</option>
        <option value="LTU">Lithuania (LTU)</option>
        <option value="LUX">Luxembourg (LUX)</option>

        <!-- M -->
        <option value="MAD">Madagascar (MAD)</option>
        <option value="MAR">Morocco (MAR)</option>
        <option value="MAS">Malaysia (MAS)</option>
        <option value="MAW">Malawi (MAW)</option>
        <option value="MDA">Republic of Moldova (MDA)</option>
        <option value="MDV">Maldives (MDV)</option>
        <option value="MEX">Mexico (MEX)</option>
        <option value="MGL">Mongolia (MGL)</option>
        <option value="MHL">Marshall Islands (MHL)</option>
        <option value="MKD">North Macedonia (MKD)</option>
        <option value="MLI">Mali (MLI)</option>
        <option value="MLT">Malta (MLT)</option>
        <option value="MNE">Montenegro (MNE)</option>
        <option value="MON">Monaco (MON)</option>
        <option value="MOZ">Mozambique (MOZ)</option>
        <option value="MRI">Mauritius (MRI)</option>
        <option value="MTN">Mauritania (MTN)</option>
        <option value="MYA">Myanmar (MYA)</option>

        <!-- N -->
        <option value="NAM">Namibia (NAM)</option>
        <option value="NCA">Nicaragua (NCA)</option>
        <option value="NED">Netherlands (NED)</option>
        <option value="NEP">Nepal (NEP)</option>
        <option value="NGR">Nigeria (NGR)</option>
        <option value="NIG">Niger (NIG)</option>
        <option value="NOR">Norway (NOR)</option>
        <option value="NRU">Nauru (NRU)</option>
        <option value="NZL">New Zealand (NZL)</option>

        <!-- O -->
        <option value="OMA">Oman (OMA)</option>

        <!-- P -->
        <option value="PAK">Pakistan (PAK)</option>
        <option value="PAN">Panama (PAN)</option>
        <option value="PAR">Paraguay (PAR)</option>
        <option value="PER">Peru (PER)</option>
        <option value="PHI">Philippines (PHI)</option>
        <option value="PLE">Palestine (PLE)</option>
        <option value="PLW">Palau (PLW)</option>
        <option value="PNG">Papua New Guinea (PNG)</option>
        <option value="POL">Poland (POL)</option>
        <option value="POR">Portugal (POR)</option>
        <option value="PRK">Democratic People's Republic of Korea (PRK)</option>
        <option value="PUR">Puerto Rico (PUR)</option>

        <!-- Q -->
        <option value="QAT">Qatar (QAT)</option>

        <!-- R -->
        <option value="ROU">Romania (ROU)</option>
        <option value="RSA">South Africa (RSA)</option>
        <option value="RWA">Rwanda (RWA)</option>

        <!-- S -->
        <option value="SAM">Samoa (SAM)</option>
        <option value="SEN">Senegal (SEN)</option>
        <option value="SEY">Seychelles (SEY)</option>
        <option value="SIN">Singapore (SIN)</option>
        <option value="SKN">Saint Kitts and Nevis (SKN)</option>
        <option value="SLE">Sierra Leone (SLE)</option>
        <option value="SLO">Slovenia (SLO)</option>
        <option value="SMR">San Marino (SMR)</option>
        <option value="SOL">Solomon Islands (SOL)</option>
        <option value="SOM">Somalia (SOM)</option>
        <option value="SRB">Serbia (SRB)</option>
        <option value="SRI">Sri Lanka (SRI)</option>
        <option value="SSD">South Sudan (SSD)</option>
        <option value="STP">SÃ£o TomÃ© and PrÃ­ncipe (STP)</option>
        <option value="SUD">Sudan (SUD)</option>
        <option value="SUI">Switzerland (SUI)</option>
        <option value="SUR">Suriname (SUR)</option>
        <option value="SVK">Slovakia (SVK)</option>
        <option value="SWE">Sweden (SWE)</option>
        <option value="SWZ">Eswatini (SWZ)</option>
        <option value="SYR">Syrian Arab Republic (SYR)</option>

        <!-- T -->
        <option value="TAN">United Republic of Tanzania (TAN)</option>
        <option value="TGA">Tonga (TGA)</option>
        <option value="THA">Thailand (THA)</option>
        <option value="TJK">Tajikistan (TJK)</option>
        <option value="TKM">Turkmenistan (TKM)</option>
        <option value="TLS">Timor-Leste (TLS)</option>
        <option value="TOG">Togo (TOG)</option>
        <option value="TPE">Chinese Taipei (TPE)</option>
        <option value="TRI">Trinidad and Tobago (TRI)</option>
        <option value="TUN">Tunisia (TUN)</option>
        <option value="TUR">TÃ¼rkiye (TUR)</option>
        <option value="TUV">Tuvalu (TUV)</option>

        <!-- U -->
        <option value="UAE">United Arab Emirates (UAE)</option>
        <option value="UGA">Uganda (UGA)</option>
        <option value="UKR">Ukraine (UKR)</option>
        <option value="URU">Uruguay (URU)</option>
        <option value="USA">United States (USA)</option>
        <option value="UZB">Uzbekistan (UZB)</option>

        <!-- V -->
        <option value="VAN">Vanuatu (VAN)</option>
        <option value="VEN">Venezuela (VEN)</option>
        <option value="VIE">Viet Nam (VIE)</option>

        <!-- Y -->
        <option value="YEM">Yemen (YEM)</option>

        <!-- Z -->
        <option value="ZAM">Zambia (ZAM)</option>
        <option value="ZIM">Zimbabwe (ZIM)</option>
    </select>
</div>


                            <!-- Age (Optional) -->
                            <div class="form-group">
                                <label for="botAge">Age</label>
                                <input 
                                    type="number" 
                                    id="botAge" 
                                    placeholder="e.g., 28"
                                    min="18"
                                    max="80">
                                <small class="field-help">Optional</small>
                            </div>

                            <!-- Riding Style (Optional) -->
                            <div class="form-group">
                                <label for="botRidingStyle">Riding Style</label>
                                <select id="botRidingStyle">
                                    <option value="">Select riding style</option>
                                    <option value="Climber">Climber</option>
                                    <option value="Sprinter">Sprinter</option>
                                    <option value="All-Rounder">All-Rounder</option>
                                    <option value="Time Trialist">Time Trialist</option>
                                    <option value="Rouleur">Rouleur</option>
                                    <option value="Puncheur">Puncheur</option>
                                </select>
                                <small class="field-help">Optional</small>
                            </div>

                            <!-- Profile Image Upload -->
                            <div class="form-group">
                                <label for="botImage">Profile Image *</label>
                                <div class="image-upload-wrapper">
                                    <input 
                                        type="file" 
                                        id="botImage" 
                                        accept="image/jpeg,image/png,image/webp"
                                        style="display: none;">
                                    <button type="button" class="btn btn-secondary" onclick="document.getElementById('botImage').click()">
                                        Choose Image
                                    </button>
                                    <span id="imageFileName" class="file-name">No file chosen</span>
                                </div>
                                <small class="field-help">JPG, PNG, or WebP. Max 2MB. Recommended: 800x800px square</small>
                                <div id="imagePreview" class="image-preview" style="display: none;">
                                    <img id="previewImg" src="" alt="Preview">
                                    <button type="button" class="btn btn-small btn-secondary" onclick="clearImage()">Remove</button>
                                </div>
                                <div id="existingImage" class="existing-image" style="display: none;">
                                    <p>Current image:</p>
                                    <img id="existingImg" src="" alt="Current">
                                    <small>Upload a new image to replace</small>
                                </div>
                            </div>

                            <!-- Backstory -->
                            <div class="form-group">
                                <label for="botBackstory">Backstory *</label>
                                <textarea 
                                    id="botBackstory" 
                                    rows="8" 
                                    placeholder="Write 2 paragraphs with a comedy edge. Real cyclist backstory but funny. Separate paragraphs with double line break."
                                    required></textarea>
                                <small class="field-help">Max 2 paragraphs. Tone: real cyclist backstory with comedy edge</small>
                                <div class="character-count">
                                    <span id="charCount">0</span> characters
                                </div>
                            </div>

                            <!-- Submit Buttons -->
                            <div class="form-actions">
                                <button type="button" id="previewBtn" class="btn btn-secondary">Preview</button>
                                <button type="submit" id="submitBtn" class="btn btn-primary">
                                    <span id="submitText">Save Profile</span>
                                    <span id="submitSpinner" class="button-spinner" style="display: none;"></span>
                                </button>
                            </div>

                            <div id="formMessage" class="form-message" style="display: none;"></div>
                        </form>
                    </div>

                    <!-- Right Side: Profile List -->
                    <div class="admin-list-container">
                        <div class="section-header">
                            <h2>Existing Profiles</h2>
                            <span id="profileCount" class="profile-count">0</span>
                        </div>

                        <div class="search-box">
                            <input type="text" id="searchProfiles" placeholder="Search profiles...">
                        </div>

                        <div id="profilesList" class="profiles-list">
                            <div class="loading-spinner">
                                <div class="spinner"></div>
                                <p>Loading profiles...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Preview Modal -->
    <div class="modal" id="previewModal">
        <div class="modal-overlay" id="previewModalOverlay"></div>
        <div class="modal-content profile-modal-content">
            <button class="modal-close" id="previewModalClose">&times;</button>
            <div id="previewModalBody" class="profile-modal-body">
                <!-- Preview will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal" id="deleteModal">
        <div class="modal-overlay" id="deleteModalOverlay"></div>
        <div class="modal-content" style="max-width: 500px;">
            <button class="modal-close" id="deleteModalClose">&times;</button>
            <h2 class="modal-title">Delete Profile?</h2>
            <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                Are you sure you want to delete this bot profile? This action cannot be undone.
            </p>
            <div id="deleteProfileInfo" style="background: var(--dark-card); padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem;">
                <!-- Profile info will be inserted here -->
            </div>
            <div style="display: flex; gap: 1rem;">
                <button id="confirmDelete" class="btn btn-primary" style="background: #dc3545;">Delete Profile</button>
                <button id="cancelDelete" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <script type="module" src="app.js"></script>
    <script type="module" src="admin-bots.js"></script>
</body>
</html>
